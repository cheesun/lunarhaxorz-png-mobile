<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>

</title>
<style type="text/css">
</style>
</head>
<body>
<script type="text/javascript"><!--


(function () {
 var _DB_ERROR;
 var _DB;
 var _read, _show;
 var _el, _e2;

 _DB_TRANS_ERROR = function (_Error) {
  console.log("SQL Transaction error (" + _Error.code  + ")");
 };
 _DB_EXEC_ERROR = function (_Transaction, _Error) {
  console.log("SQL Execution error (" + _Error.code  + ")");
 };

 _el = document.createElement("div");
 document.body.appendChild(_el);
 _e2 = document.createElement("h1");
 _el.appendChild(_e2);
 _e2.appendChild(document.createTextNode("Patient Summary"));

 _DB = window.openDatabase("TestDataBase", "1.0", "TEST", 1048576);

 _read = function () {
  _DB.transaction (function (_Transaction) {
   _Transaction.executeSql("select * from summaries where patient = 3 order by date desc limit 1", [], function (__Transaction, __Result) {
    _DB.transaction (function (_Transaction) {
     _Transaction.executeSql("select * from summaries inner join summaryValues on summaries.rowid = summaryValues.summary inner join dataPoints on summaryValues.dataPoint = dataPoints.rowid where summaries.rowid = " + __Result.rows.item(0).id, [], _show, _DB_EXEC_ERROR);
    }, _DB_TRANS_ERROR, null);
   }, _DB_EXEC_ERROR);
  }, _DB_TRANS_ERROR, null);
 }

 _show = function (_Transaction, _Result) {
  var __l = _Result.rows.length;
  var __n;


  for (__n = 0; __n < __l; __n++) {
   console.log("Row = " + __n + " ID = " + _Result.rows.item(__n).field + " R =  " + _Result.rows.item(__n).result);
console.log(_Result.rows.item(__n));
  }

 }

 _read();


})();





//--></script>
</body>
</html>